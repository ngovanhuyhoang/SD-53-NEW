@model QuanApi.Data.DanhMuc

<form id="createForm">
    <div class="mb-3">
        <label asp-for="MaDanhMuc" class="form-label">Mã danh mục</label>
        <div class="input-group">
            <input asp-for="MaDanhMuc" class="form-control" readonly required />
            <button type="button" class="btn btn-outline-secondary" onclick="generateMaDanhMuc()">
                <i class="fas fa-sync-alt"></i> Tạo mã
            </button>
        </div>
        <small class="form-text text-muted">Mã danh mục sẽ được tự động tạo</small>
        <span asp-validation-for="MaDanhMuc" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="TenDanhMuc" class="form-label">Tên danh mục</label>
        <input asp-for="TenDanhMuc" class="form-control" required />
        <span asp-validation-for="TenDanhMuc" class="text-danger"></span>
    </div>

    <div class="mb-3 form-check">
        <!-- Trick: hidden input để nếu checkbox không được tick thì vẫn gửi giá trị false -->
        <input type="hidden" name="TrangThai" value="false" />
        <input asp-for="TrangThai" class="form-check-input" />
        <label asp-for="TrangThai" class="form-check-label">Kích hoạt</label>
    </div>
</form>

<script>
    // Auto-generate MaDanhMuc when page loads
    document.addEventListener('DOMContentLoaded', function() {
        generateMaDanhMuc();
    });
    
    // Generate MaDanhMuc function
    function generateMaDanhMuc() {
        const now = new Date();
        const year = now.getFullYear().toString().substr(-2);
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        const hour = now.getHours().toString().padStart(2, '0');
        const minute = now.getMinutes().toString().padStart(2, '0');
        const second = now.getSeconds().toString().padStart(2, '0');
        const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        
        const maDanhMuc = `DM${year}${month}${day}${hour}${minute}${second}${random}`;
        document.querySelector('input[name="MaDanhMuc"]').value = maDanhMuc;
    }
</script>
